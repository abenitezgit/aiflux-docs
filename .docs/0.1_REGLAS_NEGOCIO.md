# ðŸ’¼ REGLAS DE NEGOCIO Y DOMINIO

> **Documento Maestro de DefiniciÃ³n Funcional**
> Este archivo define la estructura lÃ³gica, las jerarquÃ­as y el comportamiento esperado de `Docs.ai`.
> **Objetivo:** Preservar la lÃ³gica del proyecto Legacy (0_) y guiar la Arquitectura (1_).

---

## 1. JerarquÃ­as Principales
El sistema maneja dos flujos de organizaciÃ³n distintos que conviven en la misma base de datos, diferenciados por el `tipo` de contenedor y su comportamiento.

### A. Flujo de Conocimiento (Cuadernos)
Estructura clÃ¡sica para documentaciÃ³n pasiva y apuntes.
`Biblioteca (CategorÃ­a) -> Cuaderno -> Tema -> Nota -> [Adjuntos + Etiquetas]`

### B. Flujo de AcciÃ³n (Proyectos)
Estructura activa orientada a objetivos, plazos y tareas.
`Biblioteca (CategorÃ­a) -> Proyecto -> (Tareas + Temas) -> Nota -> [Adjuntos + Etiquetas]`

---

## 2. DefiniciÃ³n de Entidades

### ðŸ“š Contenedores Macro
1.  **Biblioteca (CategorÃ­a):**
    *   Nivel superior de agrupaciÃ³n.
    *   Propiedades: Nombre, Icono, Color.
    *   Regla: Todo Cuaderno o Proyecto debe pertenecer a una Biblioteca.

2.  **Cuaderno (Notebook):**
    *   **Tipo:** `cuaderno`
    *   Contenedor pasivo de informaciÃ³n.
    *   Objetivo: Archivar conocimiento.
    *   VisualizaciÃ³n: Ãrbol de temas y notas estÃ¡ndar.

3.  **Proyecto:**
    *   **Tipo:** `proyecto`
    *   Contenedor activo.
    *   Propiedades extra: `fecha_limite`, `estado` (activo/archivado), `progreso` (calculado por tareas completadas).
    *   **Diferenciador Clave:** Posee una colecciÃ³n de **Tareas** propias, ademÃ¡s de los Temas/Notas.

### ðŸ—‚ï¸ OrganizaciÃ³n Interna
4.  **Tema (Topic):**
    *   Sub-divisiÃ³n obligatoria dentro de un Cuaderno o Proyecto.
    *   ActÃºa como "CapÃ­tulo".
    *   Regla: Toda nota debe pertenecer a un Tema.

5.  **Nota (AnotaciÃ³n):**
    *   Unidad atÃ³mica de contenido.
    *   Contenido: HTML rico (Editor TipTap).
    *   **Componentes SatÃ©lite (Persistentes en DB):**
        *   **Etiquetas (Tags):** Array de strings almacenado en la tabla `anotaciones`.
        *   **Adjuntos:** Archivos (PDF, ImÃ¡genes) almacenados en la tabla `adjuntos` y vinculados a la nota.

6.  **Tarea:**
    *   Unidad de acciÃ³n (To-Do).
    *   Estado binario: Pendiente / Hecho.
    *   **VinculaciÃ³n:**
        *   A un **Proyecto**: Tareas especÃ­ficas para completar el proyecto.
        *   **Suelta (Inbox/Agenda):** Tareas rÃ¡pidas sin proyecto asignado.

---

## 3. MÃ³dulos Transversales

### ðŸ” Omnibar (Command Center)
*   **Acceso:** Tecla rÃ¡pida `Ctrl + K`.
*   **Funciones:** BÃºsqueda Global (Notas/Tareas), Comandos RÃ¡pidos (`/tarea`, `/nota`), NavegaciÃ³n.

### ðŸ“ Editor (Isla Persistente)
*   Drag & Drop de imÃ¡genes (Inline).
*   Panel Inspector (Derecha) para Adjuntos y Etiquetas.

---

## 4. Vistas del Sistema (View Modes)

### 4.1 Dashboard (Cockpit)
Es la vista de entrada ("Lo GenÃ©rico"). Debe respetar estrictamente el diseÃ±o de 3 zonas:
1.  **Columna Izquierda (Agenda):**
    *   Lista vertical de Tareas pendientes (globales y de proyectos).
    *   Input inferior para "AÃ±adir tarea rÃ¡pida".
2.  **Columna Derecha Superior (Proyectos Activos):**
    *   Tarjetas (Cards) de proyectos con `estado='activo'`.
    *   Debe mostrar: Nombre, Fecha lÃ­mite, Barra de progreso (%) y conteo de tareas (x/y).
3.  **Columna Derecha Medio (Notas Recientes):**
    *   Lista simple de las Ãºltimas 5 notas editadas.
4.  **Columna Derecha Inferior (Biblioteca Completa):**
    *   Grid de todas las CategorÃ­as con acceso directo a sus Cuadernos.

### 4.2 Notebook (Modo Cuaderno)
*   Sidebar: Ãrbol de Temas.
*   Main: Lectura/Escritura.

### 4.3 Project (Modo Proyecto)
*   Sidebar: **Lista de Tareas del Proyecto** + Lista de Temas.
*   Main: Lectura/Escritura.

---

## 5. Reglas de Integridad
*   **EliminaciÃ³n en Cascada:** Borrar padre elimina hijos.
*   **Seguridad (RLS):** Filtrado obligatorio por `user_id`.

# ðŸ’¼ REGLAS DE NEGOCIO Y DOMINIO (v2.2)

> **Documento Maestro de DefiniciÃ³n Funcional**
> **Objetivo:** Preservar la lÃ³gica del proyecto y guiar la evoluciÃ³n visual/funcional.

---

## 1. JerarquÃ­as Principales
(Sin cambios en la lÃ³gica de base, pero con nueva definiciÃ³n visual)
*   **VisualizaciÃ³n de JerarquÃ­a:** Se adopta el patrÃ³n de "Timeline" (hilos y nodos) para representar la profundidad de la informaciÃ³n.
    *   **Nodos Principales:** CategorÃ­as y Temas.
    *   **Nodos Secundarios:** Cuadernos y Notas.

## 2. DefiniciÃ³n de Entidades
(Se mantienen las definiciones anteriores, aÃ±adiendo reglas de UI)

### ðŸ“š Contenedores Macro
*   **Biblioteca (CategorÃ­a):** Se visualiza como una **Tarjeta Persistente**. Debe reaccionar visualmente a su estado (Abierta/Cerrada/Hover).
*   **Cuaderno (Notebook):** ActÃºa como un nodo intermedio en el timeline de la categorÃ­a.

### ðŸ—‚ï¸ OrganizaciÃ³n Interna
*   **Tema (Topic):** ActÃºa como el "CapÃ­tulo" y origen de una lÃ­nea de tiempo secundaria dentro del cuaderno.
*   **Nota:** Unidad atÃ³mica. Se representa como un nodo brillante en el timeline cuando estÃ¡ activa.

---

## 3. MÃ³dulos Transversales
*   **Resizable Sidebar (Zona 2):** El usuario puede ajustar el ancho de la navegaciÃ³n (200px - 600px). El sistema debe recordar esta preferencia vÃ­a `localStorage`.

---

## 4. Vistas del Sistema (View Modes)

### 4.1 Dashboard (Cockpit)
*   **Zona 2:** Muestra la "Vista Biblioteca" (Tarjetas de categorÃ­as).
*   **Regla de Apertura:** Al inicio/refresh, solo se abre la categorÃ­a `GENERAL`.

### 4.2 Notebook (Modo Cuaderno)
*   **Zona 2:** Se transforma en "Vista Cuaderno" (Timeline de Temas y Notas).
*   **NavegaciÃ³n:** Debe incluir un botÃ³n de retroceso y breadcrumbs (`CategorÃ­a / Cuaderno`).
*   **Persistencia:** Al volver al Dashboard, el sistema debe recordar quÃ© categorÃ­a estaba abierta y quÃ© cuaderno estaba seleccionado.

---

## 5. Reglas de Integridad
*   **Seguridad (RLS):** Filtrado obligatorio por `user_id` en todos los niveles (CategorÃ­a -> Cuaderno -> Tema -> Nota).