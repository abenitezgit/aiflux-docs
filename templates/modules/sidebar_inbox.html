<!-- templates/modules/sidebar_inbox.html -->

<!-- Añadimos hx-trigger para que se recargue cuando se capture una nota -->
<div id="inbox-sidebar-container" 
     class="flex flex-col h-full space-y-4 fade-in-up select-none"
     hx-get="/partial/sidebar/inbox"
     hx-trigger="update-inbox-list from:body"
     hx-target="this"
     hx-swap="outerHTML">
    
    <!-- Título de Ruta -->
    <div class="px-2 mb-2">
        <div class="flex items-center gap-2 text-[10px] font-bold text-amber-500 uppercase tracking-widest">
            <i class="ph-bold ph-tray"></i>
            <span>General <i class="ph ph-caret-right text-[8px] mx-1"></i> Inbox</span>
        </div>
    </div>

    <!-- Lista de Tarjetas de Notas -->
    <div class="space-y-3">
        {% for nota in notas %}
            <div class="group note-card bg-[#1a1d26] p-4 rounded-xl border border-white/5 hover:border-amber-500/30 transition-all cursor-pointer relative"
                @click="switchActiveNote('{{ nota.id }}')">
                
                <div class="flex justify-between items-start mb-2">
                    <h4 class="text-xs font-bold text-slate-200 truncate pr-6">{{ nota.titulo }}</h4>
                    
                    <!-- Engranaje: El .stop es VITAL para que al configurar la nota no se intente editarla -->
                    <button class="gear-button"
                            @click.stop="openGearMenu($event, '{{ nota.id }}')"
                            type="button">
                        <i class="ph-bold ph-gear text-sm"></i>
                    </button>
                </div>

                <p class="text-[11px] text-slate-500 line-clamp-3 leading-relaxed">
                    {{ nota.resumen_texto }}
                </p>

                <div class="mt-3 text-[9px] text-slate-600 font-mono">
                    {{ nota.created_at.strftime('%d %b, %H:%M') }}
                </div>
            </div>
        {% else %}
        <div class="py-12 text-center">
            <i class="ph ph-sparkle text-slate-700 text-3xl mb-2"></i>
            <p class="text-xs text-slate-600">Bandeja vacía</p>
        </div>
        {% endfor %}
    </div>
</div>